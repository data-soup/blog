<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Machine Learning’s Security Layer, an Overview | data soup</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Machine Learning’s Security Layer, an Overview" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This is a shallow overview of the security of machine learning systems. Within a few scrolls we’ll go through:" />
<meta property="og:description" content="This is a shallow overview of the security of machine learning systems. Within a few scrolls we’ll go through:" />
<link rel="canonical" href="https://data-soup.github.io/blog/security/2018/10/02/machine-learning-security.html" />
<meta property="og:url" content="https://data-soup.github.io/blog/security/2018/10/02/machine-learning-security.html" />
<meta property="og:site_name" content="data soup" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-02T15:39:28-05:00" />
<script type="application/ld+json">
{"description":"This is a shallow overview of the security of machine learning systems. Within a few scrolls we’ll go through:","headline":"Machine Learning’s Security Layer, an Overview","dateModified":"2018-10-02T15:39:28-05:00","datePublished":"2018-10-02T15:39:28-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://data-soup.github.io/blog/security/2018/10/02/machine-learning-security.html"},"url":"https://data-soup.github.io/blog/security/2018/10/02/machine-learning-security.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://data-soup.github.io/blog/feed.xml" title="data soup" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Machine Learning’s Security Layer, an Overview | data soup</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Machine Learning’s Security Layer, an Overview" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This is a shallow overview of the security of machine learning systems. Within a few scrolls we’ll go through:" />
<meta property="og:description" content="This is a shallow overview of the security of machine learning systems. Within a few scrolls we’ll go through:" />
<link rel="canonical" href="https://data-soup.github.io/blog/security/2018/10/02/machine-learning-security.html" />
<meta property="og:url" content="https://data-soup.github.io/blog/security/2018/10/02/machine-learning-security.html" />
<meta property="og:site_name" content="data soup" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-02T15:39:28-05:00" />
<script type="application/ld+json">
{"description":"This is a shallow overview of the security of machine learning systems. Within a few scrolls we’ll go through:","headline":"Machine Learning’s Security Layer, an Overview","dateModified":"2018-10-02T15:39:28-05:00","datePublished":"2018-10-02T15:39:28-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://data-soup.github.io/blog/security/2018/10/02/machine-learning-security.html"},"url":"https://data-soup.github.io/blog/security/2018/10/02/machine-learning-security.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://data-soup.github.io/blog/feed.xml" title="data soup" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">data soup</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Machine Learning&#39;s Security Layer, an Overview</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2018-10-02T15:39:28-05:00" itemprop="datePublished">
        Oct 2, 2018
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#security">security</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>This is a shallow overview of the security of machine learning systems. Within a few scrolls we’ll go through:</p>

<ul>
  <li>️<a href="#adversarial-examples">Adversarial Example</a></li>
  <li><a href="#model-theft">Model Theft</a></li>
  <li><a href="#dataset-poisoning">Dataset Poisoning</a></li>
  <li><a href="#dataset-protection">Dataset Protection</a></li>
</ul>

<h2 id="️adversarial-examples">️Adversarial Examples</h2>

<p>The adversarial examples (AE) topic is fascinating and an <a href="https://arxiv.org/search/advanced?advanced=&amp;terms-0-operator=AND&amp;terms-0-term=adversarial+examples&amp;terms-0-field=title&amp;classification-computer_science=y&amp;classification-physics_archives=all&amp;classification-statistics=y&amp;date-filter_by=all_dates&amp;date-year=&amp;date-from_date=&amp;date-to_date=&amp;size=50&amp;order=-announced_date_first">active</a> area of research. It raises fundamental questions related to the limits and the security of our current gradient-based classifier architectures. AE are cleverly crafted data designed to be misclassified by a targeted model. They are “designed to cause the model to make a mistake” (<a href="https://blog.openai.com/adversarial-example-research/">OpenAI</a>, Attacking Machine Learning with Adversarial Examples). The image on the right is an adversarial example.</p>

<p><img src="ml-sec/adversarial-example-dog.png" width="600" /></p>

<p>The difference between the left and the rightmost dog is probably unperceptible. This can be due to our eyes limitations (or the bit depth of your monitor).
And yet they are crucial to various models. The last image is indeed <a href="https://github.com/maxpv/maxpv.github.io/blob/master/notebooks/Adversarial_ResNet50.ipynb">considered</a> as a <code class="highlighter-rouge">plane</code> by a <code class="highlighter-rouge">ResNet50</code> initialized with default training weight in Keras, and one AE will probably work on another architecture. The only difference are small pixels values, amplified in the second picture.</p>

<p>We can notice that <code class="highlighter-rouge">ResNet50</code> was pretty confident that the dog on the left picture is a <code class="highlighter-rouge">golden_retriever</code> (~80%) and the crafted image is a <code class="highlighter-rouge">plane</code> with a higher confidence (~99%). So a model can be tricked into making a mistake with the confidence score we desire, we in general just need to train it long enough. What are the impacts of misclassifying with an arbitrary confidence score?</p>

<p>Recommendation systems are also studied for <a href="https://arxiv.org/pdf/1809.08336.pdf">adversarial recommendation</a>, influencing a recommendation system through indistinguishable fake users.</p>

<h4 id="safety">Safety</h4>

<p>In most known models, any image can be crafted into another class with an arbitrary confidence score.
So our dog can be misclassified as anything we wish with any arbitrary accuracy.
It has been shown that it works in the physical world too, for instance, if we <a href="https://arxiv.org/abs/1607.02533">print</a> them. A famous example is tricking a car’s sensor to see
a speed limit instead of a STOP sign. The output of a model can be manipulated into making to some extent, a desired decision or at generating unhandled behavior by the application that relies on it.</p>

<p><img src="/images/ml-sec/street-signs.jpg" alt="https://arxiv.org/pdf/1602.02697.pdf page 3" /></p>

<p>By the end of 2017 some showed that modifying one pixel can be enough in some cases. If you want to know more about this you can read
the paper <a href="https://arxiv.org/abs/1710.08864">One pixel attack for fooling deep neural networks</a>, enjoy a high-level presentation by
the <a href="https://www.youtube.com/watch?v=SA4YEAWVpbk">One minute paper</a> channel or check this <a href="https://github.com/Hyperparticle/one-pixel-attack-keras">Keras implementation</a>.</p>

<p>Adversarial examples are simple attack and don’t require much computation. On relatively small images a good GPU can craft an AE in less than a minute.
This is a real security issue and that is probably why we can read those line at the end of some related subject <a href="https://arxiv.org/abs/1602.02697">papers</a>:</p>

<blockquote>
  <p>Research was also supported in part by the Army Research Laboratory, under Cooperative Agreement Number W911NF-13-2-0045 (ARL Cyber Security CRA), and the Army Research Office under grant W911NF-13-1-0421.</p>
</blockquote>

<h4 id="different-threats-level-and-techniques">Different threats level and techniques</h4>

<p>We know that adversarial examples play with the decision boundaries of a classifier. We can, for instance, add random pixels on an image and <em>change</em> the classification or wisely choose those added pixels and <em>choose</em> the classification. Depending on the threat objective we denote:</p>

<ul>
  <li>Confidence reduction increases the ambiguity between classes by reducing the model’s confidence for a given image.</li>
  <li>Misclassification changes the output class to <em>another</em> class than the original one.</li>
  <li>Targeted misclassification forces the output of a specific input to be a specific target class.</li>
</ul>

<p>Depending on the opponent’s knowledge, there are three ways of crafting adversarial examples. Each with their own assumed prior knowledge of the target. Knowing:</p>

<ul>
  <li>the model as a whole including its weights (<em>gradient-base</em>),</li>
  <li>only the score of each class (<em>score-based</em>),</li>
  <li>only the prediction (<em>transfer-based</em>).</li>
</ul>

<p>A simplified copy of a diagram by Papernot. et al in The Limitations of Deep Learning in Adversarial Settings (page 3):</p>

<p><img src="/images/ml-sec/threat-model-taxonomy.png" alt="Simplified copy of a diagram by Papernot. et al in The Limitations of Deep Learning in Adversarial Settings (page 3)" width="600" /></p>

<p>One example of <strong>gradient-base attack</strong> consists in computing the loss’ gradient function an image. Following by a tiny step in the opposite gradient’s direction. In order to keep valid RGB values, the image might be clipped between 0 and 255 and the value of the noise between 0 and a small value, M.
This value M determine the maximum difference between the original image and the adversarial one, so M should be smaller than a human’s color sensibility (through a monitor). M smaller than 5 should be fine.
The previous technique is called the iterative least-likely class method. Other types of gradient techniques exist like a fast gradient sign method. You can read <a href="https://arxiv.org/abs/1607.02533">this paper</a> (part 2, page 3). We can note that they all require a complete knowledge of the model and its weights.</p>

<p><strong>Score-based attacks</strong> rely only on the predicted model’s score to estimate the gradient and then apply the previous technique.
<strong>Transfer-based attacks</strong> rely exclusively on the output label. This is a more realistic scenario compared to score-based and gradient-based. You can find
an example of a transfer-based attack in the section Model Theft.</p>

<h4 id="defence">Defence</h4>

<p>Here we won’t go much in depth I encourage you to search the keywords that attract you, it deserves a blog post on its own. We can see two big categories of defences:</p>

<blockquote>
  <ul>
    <li><em>Reactive</em>: where the objective is an adversarial example prior being called on by our model for an inference.</li>
    <li><em>Proactive</em>: where the objective is to make the models more resilient to this kind of attack.
<a href="https://arxiv.org/abs/1602.02697">Black Box Attacks</a> by Nicolas Papernot et al.</li>
  </ul>
</blockquote>

<p>Example of reactive defenses:</p>

<ul>
  <li><a href="https://arxiv.org/abs/1705.09064">MagNet</a> a ‘two networks’ model composed of an auto-encoder capable of reforming before being fed to a classifier. Several auto-encoder are needed here so it’s resource expensive.</li>
</ul>

<p>Example of proactive defenses:</p>

<ul>
  <li><a href="https://arxiv.org/abs/1806.05789">Random depthwise signed convolutional neural networks</a></li>
  <li>Label smoothing (2016)</li>
  <li>Mixup (2017)</li>
  <li>Adversarial training, re-training the neural network with a subset of adversarial examples</li>
  <li><a href="https://www.google.com/search?&amp;q=logit+pairing+neural+network">Logit pairing</a> this one is very new (2018) and “achieves the state of the art defense for white box and black box attacks on ImageNet”</li>
</ul>

<h2 id="model-theft">Model Theft</h2>

<p>Trying to rebuild someone’s else model or retrieve data that were used to train the model. The dataset and or the model might be confidential for their sensitive or commercial value.</p>

<blockquote>
  <p>The tension between model confidentiality and public access motivates our investigation of model extraction attacks. (<a href="https://www.usenix.org/system/files/conference/usenixsecurity16/sec16_paper_tramer.pdf">Source</a>)</p>
</blockquote>

<p>We’ll summarize briefly the <a href="https://arxiv.org/abs/1602.02697">Black Box Attacks</a> by Nicolas Papernot et al. If you want to dig this subject you might enjoy reading it. The main idea described here is to create a local substitute neural network trained with a substitute dataset crafted by the adversary. Then, using gradient-based techniques adversarial examples can be generated.</p>

<p><img src="/images/ml-sec/flowchart-black-box-attack.png" /></p>

<p>There’s no need for a labeled dataset, which can be expensive to produce. The substitute dataset is labeled using the remote DNN’s output.
Then the local dataset is locally augmented through a technique called <em>Jacobian-based Dataset Augmentation</em>.
Here is a pseudo code describing the Jacobian data augmentation (full code available on <a href="https://github.com/tensorflow/cleverhans/blob/023c3061f073e09204285949c85122da42e43d63/cleverhans/attacks_tf.py">github</a>).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def jacobian_augmentation(dataset):
  """
  - get_label: API call on the remote oracle
  - alpha: step size
  - jacobian: returns jacobian matrix of the substitute model
  """
  jacobian_dataset = []
  for sample in dataset:
    label = get_label(sample)
    jacobian_sample = sample + alpha*sign(jacobian(substitute_model, label))
    jacobian_dataset.append(jacobian_sample)

  return jacobian_dataset
</code></pre></div></div>

<p>Basically, each example is augmented by adding a small variation in direction of the gradient.</p>

<p>They emphasize that:</p>

<blockquote>
  <p>[…] this technique is not designed to maximize the substitute DNN’s accuracy but rather ensure that it approximates the oracle’s decision boundaries with few label queries.</p>
</blockquote>

<p>The choice of architecture isn’t very important since we can assume some details beforehand. There is a high chance that a CNN was used for an image classification task. It is also possible to train simultaneously several architectures.</p>

<p>An implementation of a similar attack is available on <a href="https://github.com/labsix/limited-blackbox-attacks">Github</a>.</p>

<h2 id="dataset-poisoning">Dataset Poisoning</h2>

<p>Dataset poisoning attacks aim at manipulating model’s behavior at test time.</p>

<p>Poisoning 3% of a training set managed to drop the test accuracy by 11% (<a href="https://arxiv.org/abs/1706.03691">Certified Defenses for Data Poisoning Attacks</a> by Steinhardt at al. (2017)).</p>

<p>Label flipping attack the objective is to maximize the loss function if a subset of the training example’s label is flipped, this is basically done by gradient ascent:</p>

<p><img src="/images/ml-sec/clean-label-attack.png" alt="Ali Shafahi et al. 2018 (Figure 1-b)" width="400" /></p>

<blockquote>
  <p>An attacker first chooses a target instance from the test set; a successful poisoning attack causes this target example to be misclassified during test time. Next, the attacker samples a base instance from the base class, and makes imperceptible changes to it to craft a poison instance; this poison is injected into the training data with the intent of fooling the model into labeling the target instance with the base label at test time. Finally, the model is trained on the poisoned dataset (clean dataset + poison instances). If during test time the model mistakes the target instance as being in the base class, then the poisoning attack is considered successful
<a href="https://arxiv.org/pdf/1804.00792.pdf">Poison Frogs! Targeted Clean-Label Poisoning Attacks on Neural Networks</a></p>
</blockquote>

<h2 id="dataset-protection">Dataset Protection</h2>

<h3 id="fully-homomorphic-encryption">Fully homomorphic encryption</h3>

<p><img src="/images/ml-sec/fhe-neuralnetwork.png" alt="Fast Homomorphic Evaluation of Deep Discretized Neural Networks https://eprint.iacr.org/2017/1114.pdf page 25" /></p>

<p>Fully homomorphic encryption is an encryption scheme that preserves the operation on data through encryption and decryption function. If the scheme is preserved over the addition, encrypting a sum or summing the encrypted members will give the same result.
This means that you can encrypt your data locally and send it to a server, let it do a job using only the supported operators and return you the encrypted result. You don’t need to trust the server since it won’t understand what it is manipulating.</p>

<p>Let <code class="highlighter-rouge">ENC</code> and <code class="highlighter-rouge">DEC</code> the encryption and decryption function respectively:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ENC(X1 + X2) = ENC(X1) + ENC(X2) (homomorphism)
Since X1 + X2 = DEC(ENC(X1+ X2))
We have X1 + X2 = DEC(ENC(X1) + ENC(X2))
</code></pre></div></div>

<p>If you would need to follow one person in this field, it would be <a href="https://researcher.watson.ibm.com/researcher/view.php?person=us-cbgentry">Craig Gentry</a>. He found the first FHE scheme in 2009.</p>

<blockquote>
  <p>Much of Craig’s recent work, including FHE and cryptographic multilinear maps, generally falls into the area of “lattice-based cryptography”. Unlike commonly-used cryptosystems like RSA and elliptic-curve cryptography, lattice-based cryptosystems cannot feasibly (as far as we know) be broken by quantum computers. (<a href="https://researcher.watson.ibm.com/researcher/view.php?person=us-cbgentry">IBM</a>)</p>
</blockquote>

<p>The most important part here is that if one day this encryption schemes exists we can (almost) not care about the privacy of our data we’re sending on a remote machine. If this machine is malicious it can just give you wrong results but can’t exploit your data…
Unless… If we’re talking about an FH encrypted machine learning model trying to predict something, nothing guarantees you that the model is empty at first and your opponent can still do inferences on the young model (by observing boundaries decisions and such). You should check out <a href="https://arxiv.org/abs/1711.05189">CryptoDL</a>.</p>

<h3 id="dataset-theft">Dataset theft</h3>

<p>It is also possible to recover the data used  at training by simply looking at the model’s output, <a href="https://arxiv.org/abs/1610.05820">Membership Inference Attacks Against Machine Learning Models</a>:</p>

<blockquote>
  <p>given  a  data  record  and  black-box  access  to a  model,  determine  if  the  record  was  in  the  model’s  training dataset. To perform membership inference against a target model, we make adversarial use of machine learning and train our own inference  model  to  recognize  differences  in  the  target  model’s predictions  on  the  inputs  that  it  trained  on  versus  the  inputs that  it  did  not  train  on.</p>
</blockquote>

<p>An implementation can be found <a href="https://github.com/csong27/membership-inference">here</a>.</p>

<hr />

  </div><a class="u-url" href="/blog/security/2018/10/02/machine-learning-security.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>🍜</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
